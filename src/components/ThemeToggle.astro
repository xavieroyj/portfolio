---
import { Moon, Sun } from "lucide-astro";
---

<button
    type="button"
    class="flex h-9 w-9 items-center justify-center rounded-lg bg-gray-200 ring-gray-300 transition-all hover:ring-2 dark:bg-gray-600 sm:ml-3"
    id="theme-selector"
>
    <span class="sr-only">
        Enable <span class="dark:hidden">light</span><span
            class="hidden dark:inline">dark</span
        > mode
    </span>
    <Sun size="24" class="hidden dark:inline" />
    <Moon size="24" class="dark:hidden" />
</button>

<script>
    const themeToggleButton = document.getElementById("theme-selector");
    const html = document.documentElement;

    function setTheme(isDark: boolean) {
        if (isDark) {
            html.classList.add("dark");
            localStorage.theme = "dark";
        } else {
            html.classList.remove("dark");
            localStorage.theme = "light";
        }
    }

    setTheme(
        localStorage.theme === "dark" ||
            (!("theme" in localStorage) &&
                window.matchMedia("(prefers-color-scheme: dark)").matches),
    );

    themeToggleButton?.addEventListener("click", () => {
        setTheme(!html.classList.contains("dark"));
    });
</script>
